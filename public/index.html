<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>C.H AI Town</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="layout">
      <!-- ===== 左側：2D 小鎮區（Phaser Canvas） ===== -->
      <section class="town-panel">
        <div class="logo-bar">
          <div class="logo-dot">C.H</div>
          <div class="logo-text">AI&nbsp;&nbsp;TOWN</div>
        </div>

        <!-- Phaser 遊戲掛載點 -->
        <div id="game-root" class="game-root"></div>

        <div class="hint-bar">
          💡 操作提示：電腦用鍵盤 <b>↑↓←→</b> 或點擊地圖移動角色；手機可<b>點擊小鎮任一位置</b>，角色會走過去。
        </div>
      </section>

      <!-- ===== 右側：角色 + 聊天區 ===== -->
      <section class="chat-panel">
        <!-- 角色資訊 -->
        <div class="role-info">
          <div class="role-title">
            當前角色
            <span id="current-role-label">C.H 客服</span>
          </div>
          <div id="current-role-desc" class="role-desc">
            對話、介紹服務、回覆一般問題，協助客人了解洗衣、洗鞋、精品包清潔流程。
          </div>
        </div>

        <!-- 角色選單（橫向 Tab） -->
        <div class="role-tabs" id="role-tabs">
          <button
            class="role-tab role-tab-active"
            data-role-id="ch_customer_service"
            data-role-name="C.H 客服"
          >
            🧾 C.H 客服
          </button>
          <button
            class="role-tab"
            data-role-id="shop_manager"
            data-role-name="店長"
          >
            🏪 店長
          </button>
          <button
            class="role-tab"
            data-role-id="cleaner_master"
            data-role-name="清潔師傅"
          >
            🧴 清潔師傅
          </button>
          <button
            class="role-tab"
            data-role-id="ironing_master"
            data-role-name="熨燙師傅"
          >
            ♨️ 熨燙師傅
          </button>
          <button
            class="role-tab"
            data-role-id="delivery_staff"
            data-role-name="外送員"
          >
            🚚 外送員
          </button>
        </div>

        <!-- 聊天盒 -->
        <div class="chat-box">
          <div id="chat-messages" class="chat-messages">
            <div class="msg msg-ai">
              <div class="msg-header">系統訊息 · C.H 小鎮</div>
              <div class="msg-body">
                你好，這裡是 C.H AI Town 小鎮。左邊是 2D 小鎮，有門市、倉庫、外送路線等場景；
                右邊則是不同角色的 AI 對話區。請先在上方選擇要聊天的角色，再輸入你的問題。
              </div>
            </div>
          </div>

          <!-- 範例問題 -->
          <div class="example-line">
            可試著詢問：
            <button class="chip" data-example>
              這個油漬有機會洗掉嗎？
            </button>
            <button class="chip" data-example>
              精品包清潔風險和成功率？
            </button>
            <button class="chip" data-example>
              外送可以到中和和永和嗎？
            </button>
          </div>
        </div>

        <!-- 輸入列 -->
        <div class="chat-input-area">
          <textarea
            id="chat-input"
            class="chat-input"
            rows="2"
            placeholder="輸入想問這個角色的問題，例如：這個油漬有機會洗乾淨嗎？"
          ></textarea>
          <button id="send-btn" class="chat-send-btn">送出</button>
        </div>
      </section>
    </div>

    <!-- Phaser 用來畫 2D 小鎮 -->
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.70.0/dist/phaser.min.js"></script>
    <script src="game.js"></script>

    <!-- 既有聊天邏輯（你原本的 app.js，會呼叫 /api/chat） -->
    <script src="app.js"></script>
  </body>
</html>
